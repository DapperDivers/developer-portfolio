#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Run React context safety checks
echo "üîç Checking for React context safety issues..."
node react-usage-analyzer.cjs 2>&1 | grep -B 1 -A 2 "‚ö†Ô∏è Uses destructured import" || true

# If any critical issues are found, alert but allow commit
if [ $? -eq 0 ]; then
  echo "‚ö†Ô∏è WARNING: Potentially unsafe React imports detected!"
  echo "‚ö†Ô∏è These patterns may cause errors in production builds."
  echo "‚ö†Ô∏è Consider fixing these issues before pushing to production."
  echo "‚ÑπÔ∏è  See docs/react-context-safety-guide.md for details"
fi

# ESLint check with context safety rules
echo "üîç Running ESLint with context safety rules..."
npx eslint --config eslint.config.react-context-safety.js src/context --quiet || true
